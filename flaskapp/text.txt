######create a 2 of 2 multisig and spend out of it

#Create the multisig 2 of 2
Command:
getdescriptorinfo "wsh(multi(2,xprv9uCibHTvNpZDv9NZzoj3agyDLcLfoYrjcYjzgXzUDHu9ngdqohztmFuTVtghy7gadbUoVuDPRyvMXqtBnhd34iotNKjEg29Gb3XjFG9D1Jb/0h/0h/0h,xprv9vPnVEEVBp3EuK1MVe8VXoS3A5XbkjeawgaZPzc9SnMKom29aX6yrJ6xQoqE7sLTey3tJ3QopR4SxPa4gUJXWoGWwCPS7Fh2xwSuMjsX8be/0h/0h/0h))"

Returns the same disciptor with checksum:
{
  "descriptor": "wsh(multi(2,xpub68C4znzpDC7X8dT36qG3wpuwteBAD1aaymfbUvQ5mdS8fUxzMFK9K4DwMAMaauscuv1KbzjHUq9zB1PMGrksyDhmFkxkzPjGwoZKUT6gDGu/0'/0'/0',xpub69P8tjmP2BbY7o5pbffVtwNmi7N6ACNSJuWACP1m17tJgZMJ84REQ6RSG6FEsG2DWATFRzQHEPtpTPDUQFm5cqMsm3JuMfYGwJqa7HdAvQZ/0'/0'/0'))#ep5mwtrv",
  "checksum": "wg3yrpfc",
  "isrange": false,
  "issolvable": true,
  "hasprivatekeys": true
}

#Get the checksum of the descriptor
#Run same command with the checksum of previous command appended to the descriptor
Command:
deriveaddresses "wsh(multi(2,xprv9uCibHTvNpZDv9NZzoj3agyDLcLfoYrjcYjzgXzUDHu9ngdqohztmFuTVtghy7gadbUoVuDPRyvMXqtBnhd34iotNKjEg29Gb3XjFG9D1Jb/0h/0h/0h,xprv9vPnVEEVBp3EuK1MVe8VXoS3A5XbkjeawgaZPzc9SnMKom29aX6yrJ6xQoqE7sLTey3tJ3QopR4SxPa4gUJXWoGWwCPS7Fh2xwSuMjsX8be/0h/0h/0h))#wg3yrpfc"

Returns A list of address generated from pub keys:
[
  "bc1qgww4rd4wg4c95ehp7zn8d2uupm8pmtvmpa0wztwd4u5lfwjsl4eqr0sn99"
]


##Send money to the address above


#We could not import multi with the xpriv and a suffix of /*. We can import xprivs with /0h/1h/0h or /0h/0h/0h
Command:
importmulti '[{ "desc": "wsh(multi(2,xprv9uCibHTvNpZDv9NZzoj3agyDLcLfoYrjcYjzgXzUDHu9ngdqohztmFuTVtghy7gadbUoVuDPRyvMXqtBnhd34iotNKjEg29Gb3XjFG9D1Jb/*,xprv9vPnVEEVBp3EuK1MVe8VXoS3A5XbkjeawgaZPzc9SnMKom29aX6yrJ6xQoqE7sLTey3tJ3QopR4SxPa4gUJXWoGWwCPS7Fh2xwSuMjsX8be/*))#rn4e2tnw", "timestamp": "now", "range": [0, 199], "watchonly": false, "label": "test" }]' '{"rescan": true}'

Command:
deriveaddresses "wsh(multi(2,xprv9uCibHTvNpZDv9NZzoj3agyDLcLfoYrjcYjzgXzUDHu9ngdqohztmFuTVtghy7gadbUoVuDPRyvMXqtBnhd34iotNKjEg29Gb3XjFG9D1Jb/*,xprv9vPnVEEVBp3EuK1MVe8VXoS3A5XbkjeawgaZPzc9SnMKom29aX6yrJ6xQoqE7sLTey3tJ3QopR4SxPa4gUJXWoGWwCPS7Fh2xwSuMjsX8be/*))#rn4e2tnw" "[0, 199]"

Result:
A ton of address with this as the first:
bc1ql4my9az7ww7u60cgmgrxukndzuacea7u8mxnf8shsgkgpzfe29vsfl36cx

getdescriptorinfo "pk(xprv9vPnVEEVBp3EuK1MVe8VXoS3A5XbkjeawgaZPzc9SnMKom29aX6yrJ6xQoqE7sLTey3tJ3QopR4SxPa4gUJXWoGWwCPS7Fh2xwSuMjsX8be/*)"

deriveaddresses "pk(xprv9vPnVEEVBp3EuK1MVe8VXoS3A5XbkjeawgaZPzc9SnMKom29aX6yrJ6xQoqE7sLTey3tJ3QopR4SxPa4gUJXWoGWwCPS7Fh2xwSuMjsX8be/*)#cyntrmzd" "[0, 199]"

dumpprivkey with one of those addreses returns:

L3R8vYYLmSUhs4QcDaZPW3xbzfiEj2ndRA5QHwvYga3iXY5FjaPr



deriveaddresses "pk(xprv9uCibHTvNpZDv9NZzoj3agyDLcLfoYrjcYjzgXzUDHu9ngdqohztmFuTVtghy7gadbUoVuDPRyvMXqtBnhd34iotNKjEg29Gb3XjFG9D1Jb/*)#xv9r5lgf" "[0, 199]"

dumpprivkey with one of those addreses returns:

KyWCpbe6thcmyYavFpKcoeQoyUYPMy9Cxtt9cr42VEC6YyP8ChoF

Command:

listunspent

Result:
[
  {
    "txid": "51d79e51723a4f7e67e575c1fc6665ea07732fb4d791f0f828e5b2b5ca455a28",
    "vout": 0,
    "address": "bc1qgww4rd4wg4c95ehp7zn8d2uupm8pmtvmpa0wztwd4u5lfwjsl4eqr0sn99",
    "label": "test",
    "witnessScript": "522103d63317c3f087f580ddf253eff48e3b193986bf22801415a77b5500a5458ab3a321032e734bd768d6f2cd8a6b66054a7dcf2f0ff129c919b8f539419a48bdd4a9112752ae",
    "scriptPubKey": "0020439d51b6ae45705a66e1f0a676ab9c0ece1dad9b0f5ee12dcdaf29f4ba50fd72",
    "amount": 0.00061758,
    "confirmations": 3,
    "spendable": false,
    "solvable": true,
    "desc": "wsh(multi(2,[ab63c593/0'/0'/0']03d63317c3f087f580ddf253eff48e3b193986bf22801415a77b5500a5458ab3a3,[93812041/0'/0'/0']032e734bd768d6f2cd8a6b66054a7dcf2f0ff129c919b8f539419a48bdd4a91127))#gr0elgyp",
    "safe": true
  }
]


#Create a raw transaction with the txid and the vout from the listunspent command
Command:
createrawtransaction '[{"txid": "51d79e51723a4f7e67e575c1fc6665ea07732fb4d791f0f828e5b2b5ca455a28","vout": 0}]' '[{"31smwvXUg2nRBSms4CuTmwvo9Yzj8TZpBg": 0.0002},{"bc1qgww4rd4wg4c95ehp7zn8d2uupm8pmtvmpa0wztwd4u5lfwjsl4eqr0sn99": 0.0004}]'

Result:
0200000001285a45cab5b2e528f8f091d7b42f7307ea6566fcc175e5677e4f3a72519ed7510000000000ffffffff02204e00000000000017a9140208e8a8fbcf8b759c9318c9160da143abfc624c87409c000000000000220020439d51b6ae45705a66e1f0a676ab9c0ece1dad9b0f5ee12dcdaf29f4ba50fd7200000000

#Sign the transaction with the hex from above, the txid, vout, scriptPubKey, witnessScript and Both privkeys
signrawtransactionwithkey '0200000001285a45cab5b2e528f8f091d7b42f7307ea6566fcc175e5677e4f3a72519ed7510000000000ffffffff02204e00000000000017a9140208e8a8fbcf8b759c9318c9160da143abfc624c87409c000000000000220020439d51b6ae45705a66e1f0a676ab9c0ece1dad9b0f5ee12dcdaf29f4ba50fd7200000000' '["KyWCpbe6thcmyYavFpKcoeQoyUYPMy9Cxtt9cr42VEC6YyP8ChoF","L3R8vYYLmSUhs4QcDaZPW3xbzfiEj2ndRA5QHwvYga3iXY5FjaPr"]' '[{"txid": "51d79e51723a4f7e67e575c1fc6665ea07732fb4d791f0f828e5b2b5ca455a28","vout": 0,"scriptPubKey": "0020439d51b6ae45705a66e1f0a676ab9c0ece1dad9b0f5ee12dcdaf29f4ba50fd72","witnessScript": "522103d63317c3f087f580ddf253eff48e3b193986bf22801415a77b5500a5458ab3a321032e734bd768d6f2cd8a6b66054a7dcf2f0ff129c919b8f539419a48bdd4a9112752ae","amount": 0.00061758}]'

Result:

# This is the error we run into.

  "hex": "02000000000101285a45cab5b2e528f8f091d7b42f7307ea6566fcc175e5677e4f3a72519ed7510000000000ffffffff02204e00000000000017a9140208e8a8fbcf8b759c9318c9160da143abfc624c87409c000000000000220020439d51b6ae45705a66e1f0a676ab9c0ece1dad9b0f5ee12dcdaf29f4ba50fd7203000047522103d63317c3f087f580ddf253eff48e3b193986bf22801415a77b5500a5458ab3a321032e734bd768d6f2cd8a6b66054a7dcf2f0ff129c919b8f539419a48bdd4a9112752ae00000000",
  "complete": false,
  "errors": [
    {
      "txid": "51d79e51723a4f7e67e575c1fc6665ea07732fb4d791f0f828e5b2b5ca455a28",
      "vout": 0,
      "witness": [
        "",
        "",
        "522103d63317c3f087f580ddf253eff48e3b193986bf22801415a77b5500a5458ab3a321032e734bd768d6f2cd8a6b66054a7dcf2f0ff129c919b8f539419a48bdd4a9112752ae"
      ],
      "scriptSig": "",
      "sequence": 4294967295,
      "error": "Unable to sign input, invalid stack size (possibly missing key)"
    }
  ]
}


signrawtransactionwithwallet '0200000001285a45cab5b2e528f8f091d7b42f7307ea6566fcc175e5677e4f3a72519ed7510000000000ffffffff02204e00000000000017a9140208e8a8fbcf8b759c9318c9160da143abfc624c87409c000000000000220020439d51b6ae45705a66e1f0a676ab9c0ece1dad9b0f5ee12dcdaf29f4ba50fd7200000000' '[{"txid": "51d79e51723a4f7e67e575c1fc6665ea07732fb4d791f0f828e5b2b5ca455a28","vout": 0,"scriptPubKey": "0020439d51b6ae45705a66e1f0a676ab9c0ece1dad9b0f5ee12dcdaf29f4ba50fd72","witnessScript": "522103d63317c3f087f580ddf253eff48e3b193986bf22801415a77b5500a5458ab3a321032e734bd768d6f2cd8a6b66054a7dcf2f0ff129c919b8f539419a48bdd4a9112752ae","amount": 0.00061758}]'










