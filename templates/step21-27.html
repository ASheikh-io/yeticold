<html>
 <head>
    <title>Yeti Bitcoin Storage</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet", href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet", href="{{ url_for('static', filename='bootstrap.min.css') }}">
    <script src="{{ url_for('static', filename='bootstrap.min.js') }}"></script>
  </head>
  <body>
    <nav class="form-row navbar navbar-light" style="background-color: rgb(112,196,245)!important;">
        <img src="{{url_for('static', filename='yeti.png')}}" width="50" height="50" class="align-top" alt="">
        <h3 style="color:white;margin:0;">Yeti Bitcoin Cold Storage</h3>
    </nav>
    <div class="container" style="margin-top: 3rem;">
        <h2>Step {{ i }} : Write Down Private Key {{ x }} of 7</h2>
        <ul>
            <li>These private keys were generated by combining a private key pulled from bitcoin core with the entropy you provided.</li>
            <li>They are displayed using the NATO phonetic alphabet.</li>
            <li>Each word starts with the corresponding letter and numbers are written out using the English language word. Lower case words represent lower case letters.</li>
            <li>ALFA = A, bravo = b and TWO = 2</li>
            <li>Each fifth word is not part of your private key but provides an checksum to ensure the previous four keys were entered correctly.</li>
            <li>This makes it far less likely that errors will occur when entering your private key later.</li>
            <li>Once you have written down these words on your printed packets click Next to contiune</li>
        </ul>
        <form action="" method="post" style="border: solid #f8f9fa;padding: 1.5rem;">
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">1</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[0] }} {{ PPL[1] }} {{ PPL[2] }} {{ PPL[3] }}" id="displayrow1" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">2</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[4] }} {{ PPL[5] }} {{ PPL[6] }} {{ PPL[7] }}" id="displayrow2" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">3</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[8] }} {{ PPL[9] }} {{ PPL[10] }} {{ PPL[11] }}" id="displayrow3" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">4</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[12] }} {{ PPL[13] }} {{ PPL[14] }} {{ PPL[15] }}" id="displayrow4" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">5</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[16] }} {{ PPL[17] }} {{ PPL[18] }} {{ PPL[19] }}" id="displayrow5" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">6</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[20] }} {{ PPL[21] }} {{ PPL[22] }} {{ PPL[23] }}" id="displayrow6" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">7</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[24] }} {{ PPL[25] }} {{ PPL[26] }} {{ PPL[27] }}" id="displayrow7" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">8</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[28] }} {{ PPL[29] }} {{ PPL[30] }} {{ PPL[31] }}" id="displayrow8" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">9</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[32] }} {{ PPL[33] }} {{ PPL[34] }} {{ PPL[35] }}" id="displayrow9" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">10</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[36] }} {{ PPL[37] }} {{ PPL[38] }} {{ PPL[39] }}" id="displayrow10" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">11</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[40] }} {{ PPL[41] }} {{ PPL[42] }} {{ PPL[43] }}" id="displayrow11" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">12</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[44] }} {{ PPL[45] }} {{ PPL[46] }} {{ PPL[47] }}" id="displayrow12" readonly>
          </div>
        </div>
        <div class="form-row">
          <div class="input-group col-md-10 mb-3">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1">13</span>
            </div>
            <input type="text" class="form-control" value="{{ PPL[48] }} {{ PPL[49] }} {{ PPL[50] }} {{ PPL[51] }}" id="displayrow13" readonly>
          </div>
        </div>

        <input style="background-color: rgb(112,196,245)!important;color: white;" class="btn" type="submit" id="next" value="Next">
      </form>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
<script>   
  var switcher = {
  "1": "ONE",
  "2": "TWO",
  "3": "THREE",
  "4": "FOUR",
  "5": "FIVE",
  "6": "SIX",
  "7": "SEVEN",
  "8": "EIGHT",
  "9": "NINE",
  "A": "ALFA",
  "B": "BRAVO",
  "C": "CHARLIE",
  "D": "DELTA",
  "E": "ECHO",
  "F": "FOXTROT",
  "G": "GOLF",
  "H": "HOTEL",
  "I": "INDIA",
  "J": "JULIET",
  "K": "KILO",
  "L": "LIMA",
  "M": "MIKE",
  "N": "NOVEMBER",
  "O": "OSCAR",
  "P": "PAPA",
  "Q": "QUEBEC",
  "R": "ROMEO",
  "S": "SIERRA",
  "T": "TANGO",
  "U": "UNIFORM",
  "V": "VICTOR",
  "W": "WHISKEY",
  "X": "X-RAY",
  "Y": "YANKEE",
  "Z": "ZULU",
  "a": "alfa",
  "b": "bravo",
  "c": "charlie",
  "d": "delta",
  "e": "echo",
  "f": "foxtrot",
  "g": "golf",
  "h": "hotel",
  "i": "india",
  "j": "juliet",
  "k": "kilo",
  "l": "lima",
  "m": "mike",
  "n": "november",
  "o": "oscar",
  "p": "papa",
  "q": "quebec",
  "r": "romeo",
  "s": "sierra",
  "t": "tango",
  "u": "uniform",
  "v": "victor",
  "w": "whiskey",
  "x": "x-ray",
  "y": "yankee",
  "z": "zulu",
  "ONE": "1",
  "TWO": "2",
  "THREE": "3",
  "FOUR": "4",
  "FIVE": "5",
  "SIX": "6",
  "SEVEN": "7",
  "EIGHT": "8",
  "NINE": "9",
  "ALFA": "A",
  "BRAVO": "B",
  "CHARLIE": "C",
  "DELTA": "D",
  "ECHO": "E",
  "FOXTROT": "F",
  "GOLF": "G",
  "HOTEL": "H",
  "INDIA": "I",
  "JULIET": "J",
  "KILO": "K",
  "LIMA": "L",
  "MIKE": "M",
  "NOVEMBER": "N",
  "OSCAR": "O",
  "PAPA": "P",
  "QUEBEC": "Q",
  "ROMEO": "R",
  "SIERRA": "S",
  "TANGO": "T",
  "UNIFORM": "U",
  "VICTOR": "V",
  "WHISKEY": "W",
  "X-RAY": "X",
  "YANKEE": "Y",
  "ZULU": "Z",
  "alfa": "a",
  "bravo": "b",
  "charlie": "c",
  "delta": "d",
  "echo": "e",
  "foxtrot": "f",
  "golf": "g",
  "hotel": "h",
  "india": "i",
  "juliet": "j",
  "kilo": "k",
  "lima": "l",
  "mike": "m",
  "november": "n",
  "oscar": "o",
  "papa": "p",
  "quebec": "q",
  "romeo": "r",
  "sierra": "s",
  "tango": "t",
  "uniform": "u",
  "victor": "v",
  "whiskey": "w",
  "x-ray": "x",
  "yankee": "y",
  "zulu": "z"
        }
        var BASE58_ALPHABET = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'
        var base_count = BASE58_ALPHABET.length
    var hashFour = (passphraselist) => {
      var hash = CryptoJS.SHA256(PassphraseToWIF(passphraselist)).toString(CryptoJS.enc.Hex)
      var mod = parseInt(BigInt('0x' + hash) % BigInt(58))
      var char = BASE58_ALPHABET.charAt(mod)
      return WIFToPassphrase(char)[0]
    }
    var decode = (s) => {
      var decoded = 0
      var multi = 1
      var news = s.split('').reverse().join().replace(',','').replace(',','').replace(',','').replace(',','')
      for (char in news) {
        decoded = decoded + (multi * BASE58_ALPHABET.indexOf(news.charAt(char)))
        multi = multi * base_count
      }
      return decoded
    }
    var PassphraseToWIF = (passphraselist) => {
      var WIFlist = ''
      for(var i = 0; i < passphraselist.length; i++) {
        var WIF = switcher[passphraselist[i]]
        WIFlist = WIFlist + WIF
      }
      return WIFlist
    }
    var WIFToPassphrase = (WIFString) => {
      var passphraselist = []
      for(var i = 0; i < WIFString.length; i++) {
        var passphrase = switcher[WIFString.charAt(i)]
        passphraselist.push(passphrase)
      }
      return passphraselist
    }
    var makechecksum = (passphraselist) => {
       var list = PassphraseToWIF(passphraselist)
      var sum = 0
      for (char in list) {
        var decodenum = decode(list.charAt(char))
        sum = sum + decodenum
      }
      mod = sum % 58
      var char = BASE58_ALPHABET.charAt(mod)
      char = WIFToPassphrase(char)[0]
      return char
    }
    var checksum = () => {
      for (var i = 1; i < 14; i++) {
        var fourwords = document.getElementById('displayrow' + i).value.split(' ')
        var Letter = makechecksum(fourwords)
        document.getElementById('displayrow' + i).value = document.getElementById('displayrow' + i).value + ' ' + Letter
      }
    }
    checksum()
    </script>
  </body>
</html>
